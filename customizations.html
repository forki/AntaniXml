<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Customizations
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="xml random generator"/>
    <meta name="author" content="Giacomo Citi"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link type="text/css" rel="stylesheet" href="/AntaniXml/content/style.css" />
    <script type="text/javascript" src="/AntaniXml/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://github.com/giacomociti/AntaniXml">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/AntaniXml/index.html">AntaniXml</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1><a name="Customizations" class="anchor" href="#Customizations">Customizations</a></h1>

<p>This article is about how you can customize the generated output.</p>

<h3><a name="Simply-change-the-output" class="anchor" href="#Simply-change-the-output">Simply change the output</a></h3>

<p>For some schemas the generator may produce something not correct (for example ignoring identity constraints).
Or maybe the generated values simply look ugly to you (you may want meaningful words instead of random gibberish).
Obviously one option is to change the produced output by using XSLT or by any other means. Since the output is
an <code>XElement</code>, the <code>System.Xml.Linq</code> API is already well suited for this task:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs6', 8)" onmouseover="showTip(event, 'fs6', 8)" class="i">samples</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs7', 9)" onmouseover="showTip(event, 'fs7', 9)" class="t">Schema</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 10)" onmouseover="showTip(event, 'fs8', 10)" class="f">CreateFromUri</span>(<span class="s">&quot;foo.xsd&quot;</span>)
          <span class="o">.</span><span class="f">Generator</span>(<span onmouseout="hideTip(event, 'fs9', 11)" onmouseover="showTip(event, 'fs9', 11)" class="t">XmlQualifiedName</span>(<span class="s">&quot;e1&quot;</span>))
          <span class="o">.</span><span class="f">Generate</span>(<span class="n">10</span>)

<span onmouseout="hideTip(event, 'fs6', 12)" onmouseover="showTip(event, 'fs6', 12)" class="i">samples</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs10', 13)" onmouseover="showTip(event, 'fs10', 13)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs11', 14)" onmouseover="showTip(event, 'fs11', 14)" class="f">mapi</span> (<span class="k">fun</span> <span onmouseout="hideTip(event, 'fs12', 15)" onmouseover="showTip(event, 'fs12', 15)" class="i">i</span> <span onmouseout="hideTip(event, 'fs13', 16)" onmouseover="showTip(event, 'fs13', 16)" class="i">xml</span> <span class="k">-&gt;</span>
    <span class="k">for</span> <span onmouseout="hideTip(event, 'fs14', 17)" onmouseover="showTip(event, 'fs14', 17)" class="i">bar</span> <span class="k">in</span> <span onmouseout="hideTip(event, 'fs13', 18)" onmouseover="showTip(event, 'fs13', 18)" class="i">xml</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs15', 19)" onmouseover="showTip(event, 'fs15', 19)" class="f">Descendants</span>(<span onmouseout="hideTip(event, 'fs16', 20)" onmouseover="showTip(event, 'fs16', 20)" class="t">XName</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 21)" onmouseover="showTip(event, 'fs17', 21)" class="f">Get</span>(<span class="s">&quot;bar&quot;</span>)) <span class="k">do</span>
        <span onmouseout="hideTip(event, 'fs14', 22)" onmouseover="showTip(event, 'fs14', 22)" class="i">bar</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 23)" onmouseover="showTip(event, 'fs18', 23)" class="f">Attribute</span>(<span onmouseout="hideTip(event, 'fs16', 24)" onmouseover="showTip(event, 'fs16', 24)" class="t">XName</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 25)" onmouseover="showTip(event, 'fs17', 25)" class="f">Get</span>(<span class="s">&quot;id&quot;</span>))<span class="o">.</span><span class="i">Value</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs12', 26)" onmouseover="showTip(event, 'fs12', 26)" class="i">i</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 27)" onmouseover="showTip(event, 'fs19', 27)" class="f">ToString</span>()
    <span onmouseout="hideTip(event, 'fs13', 28)" onmouseover="showTip(event, 'fs13', 28)" class="i">xml</span>)      
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs10', 29)" onmouseover="showTip(event, 'fs10', 29)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 30)" onmouseover="showTip(event, 'fs20', 30)" class="f">iter</span> (<span onmouseout="hideTip(event, 'fs21', 31)" onmouseover="showTip(event, 'fs21', 31)" class="f">printfn</span> <span class="s">&quot;</span><span class="pf">%A</span><span class="s">&quot;</span>) 
    
</code></pre></td>
</tr>
</table>

<p>The same in C# is:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="i">var</span> <span class="i">samples</span> <span class="o">=</span> <span class="i">Schema</span><span class="o">.</span><span class="i">CreateFromUri</span>(<span class="s">&quot;foo.xsd&quot;</span>)
    <span class="o">.</span><span class="i">Generator</span>(<span class="k">new</span> <span class="i">XmlQualifiedName</span>(<span class="s">&quot;e1&quot;</span>))
    <span class="o">.</span><span class="i">Generate</span>(<span class="n">10</span>);

<span class="i">samples</span><span class="o">.</span><span class="i">Descendants</span>(<span class="s">&quot;bar&quot;</span>)
    <span class="o">.</span><span class="i">Select</span>((<span class="i">bar</span>, <span class="i">i</span>) <span class="o">=&gt;</span>
        {
            <span class="i">bar</span><span class="o">.</span><span class="i">Attribute</span>(<span class="s">&quot;id&quot;</span>)<span class="o">.</span><span class="i">Value</span> <span class="o">=</span> <span class="i">i</span><span class="o">.</span><span class="i">ToString</span>();
            <span class="k">return</span> <span class="i">bar</span>;
        })
    <span class="o">.</span><span class="i">ToList</span>()
    <span class="o">.</span><span class="i">ForEach</span>(<span class="i">Console</span><span class="o">.</span><span class="i">WriteLine</span>);
</code></pre></td>
</tr>
</table>

<p>The above example is just to get the idea. If you don't like imperative code
you can map the element to another one, but for little fixes the
mutability allowed in <code>System.Xml.Linq</code> may be just fine.</p>

<h3><a name="Providing-your-own-generators" class="anchor" href="#Providing-your-own-generators">Providing your own generators</a></h3>

<p>Custom generators are of course a superior alternative.</p>

<p>To keep things simple, customizations are allowed only for elements and for global complex types.
The only way to customize attributes and values of simple types, is to provide 
custom generators for the enclosing elements or global complex types. 
Hopefully this is an acceptable limitation for most practical purposes.</p>

<p>FsCheck provides excellent documentation about creating custom generators, both in F# and in C#.
Anyway in AntaniXml there is also an option to provide only a mapping function, so the default 
generators are still used but the generated elements are then transformed with a custom function.
Custom generators are expected to produce <code>XElement</code> instances.
In case of complex types the name of the generated element actually is not important because it
will be replaced by the proper element name required in each context.</p>

<h4><a name="Customizing-a-global-complex-type" class="anchor" href="#Customizing-a-global-complex-type">Customizing a global complex type</a></h4>

<p>The qualified name of the complex type is used as an identifier to pick up a custom generator for all the
elements explicitly defined to be of such a type.
Hence only global types can be customized since anonymous types lack a name to be used as an identifier.
Also in case of an element whose anonymous type is derived from a global one for which a customization is provided, 
the custom generator is <em>not</em> picked up.</p>

<h4><a name="Customizing-elements" class="anchor" href="#Customizing-elements">Customizing elements</a></h4>

<p>Custom generators for elements instead may have a broader reach.
When a custom generator is provided for elements with a given qualified name, that generator is used for all
elements with such a name, regardless of their type.
So, in case the schema is designed in <em>Russian doll</em> style, custom generators for elements are a better bet.
Just beware of (nasty) schemas where two distinct element definitions describe elements with the exact same name 
but different content models. In this case a custom generator may not be used because it would apply to
both element definitions.</p>

<p>Let's give a few concrete examples. In the following we'll be using this schema 
(assuming a string variable <code>xsdText</code> holds it):</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="xml"><span class="k">&lt;</span><span class="i">xs:schema</span> <span class="o">xmlns:xs</span><span class="k">="http://www.w3.org/2001/XMLSchema"</span> 
    <span class="o">elementFormDefault</span><span class="k">="qualified"</span> <span class="o">attributeFormDefault</span><span class="k">="unqualified"</span><span class="k">&gt;</span>
    <span class="k">&lt;</span><span class="i">xs:complexType</span> <span class="o">name</span><span class="k">="barType"</span><span class="k">&gt;</span>
        <span class="k">&lt;</span><span class="i">xs:attribute</span> <span class="o">name</span><span class="k">="id"</span> <span class="o">type</span><span class="k">="xs:string"</span> <span class="o">use</span><span class="k">="required"</span> <span class="k">/&gt;</span>
    <span class="k">&lt;/</span><span class="i">xs:complexType</span><span class="k">&gt;</span>
    <span class="k">&lt;</span><span class="i">xs:element</span> <span class="o">name</span><span class="k">="foo"</span><span class="k">&gt;</span>
        <span class="k">&lt;</span><span class="i">xs:complexType</span><span class="k">&gt;</span>
            <span class="k">&lt;</span><span class="i">xs:sequence</span><span class="k">&gt;</span>
                <span class="k">&lt;</span><span class="i">xs:element</span> <span class="o">name</span><span class="k">="bar"</span> <span class="o">type</span><span class="k">="barType"</span> <span class="k">/&gt;</span>
                <span class="k">&lt;</span><span class="i">xs:element</span> <span class="o">name</span><span class="k">="baz"</span> <span class="o">type</span><span class="k">="xs:string"</span> <span class="k">/&gt;</span>
            <span class="k">&lt;/</span><span class="i">xs:sequence</span><span class="k">&gt;</span>
        <span class="k">&lt;/</span><span class="i">xs:complexType</span><span class="k">&gt;</span>
    <span class="k">&lt;/</span><span class="i">xs:element</span><span class="k">&gt;</span>
<span class="k">&lt;/</span><span class="i">xs:schema</span><span class="k">&gt;</span>
</code></pre></td></tr></table>

<p>First we show a custmization for a complex type:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs22', 32)" onmouseover="showTip(event, 'fs22', 32)" class="i">FsCheck</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 33)" onmouseover="showTip(event, 'fs23', 33)" class="i">foo</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs9', 34)" onmouseover="showTip(event, 'fs9', 34)" class="t">XmlQualifiedName</span>(<span class="s">&quot;foo&quot;</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs24', 35)" onmouseover="showTip(event, 'fs24', 35)" class="i">barType</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs9', 36)" onmouseover="showTip(event, 'fs9', 36)" class="t">XmlQualifiedName</span>(<span class="s">&quot;barType&quot;</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs25', 37)" onmouseover="showTip(event, 'fs25', 37)" class="f">toUpper</span> (<span onmouseout="hideTip(event, 'fs13', 38)" onmouseover="showTip(event, 'fs13', 38)" class="i">xml</span><span class="o">:</span> <span onmouseout="hideTip(event, 'fs26', 39)" onmouseover="showTip(event, 'fs26', 39)" class="t">XElement</span>) <span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs27', 40)" onmouseover="showTip(event, 'fs27', 40)" class="i">id</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs13', 41)" onmouseover="showTip(event, 'fs13', 41)" class="i">xml</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs18', 42)" onmouseover="showTip(event, 'fs18', 42)" class="f">Attribute</span>(<span onmouseout="hideTip(event, 'fs16', 43)" onmouseover="showTip(event, 'fs16', 43)" class="t">XName</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 44)" onmouseover="showTip(event, 'fs17', 44)" class="f">Get</span>(<span class="s">&quot;id&quot;</span>))
    <span onmouseout="hideTip(event, 'fs27', 45)" onmouseover="showTip(event, 'fs27', 45)" class="i">id</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs28', 46)" onmouseover="showTip(event, 'fs28', 46)" class="i">Value</span> <span class="o">&lt;-</span> <span onmouseout="hideTip(event, 'fs27', 47)" onmouseover="showTip(event, 'fs27', 47)" class="i">id</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs28', 48)" onmouseover="showTip(event, 'fs28', 48)" class="i">Value</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs29', 49)" onmouseover="showTip(event, 'fs29', 49)" class="f">ToUpper</span>() 
    <span onmouseout="hideTip(event, 'fs13', 50)" onmouseover="showTip(event, 'fs13', 50)" class="i">xml</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs30', 51)" onmouseover="showTip(event, 'fs30', 51)" class="i">cust</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs31', 52)" onmouseover="showTip(event, 'fs31', 52)" class="t">CustomGenerators</span>()<span class="o">.</span><span class="f">ForComplexType</span>(<span onmouseout="hideTip(event, 'fs24', 53)" onmouseover="showTip(event, 'fs24', 53)" class="i">barType</span>, <span onmouseout="hideTip(event, 'fs25', 54)" onmouseover="showTip(event, 'fs25', 54)" class="f">toUpper</span>)
<span onmouseout="hideTip(event, 'fs7', 55)" onmouseover="showTip(event, 'fs7', 55)" class="t">Schema</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 56)" onmouseover="showTip(event, 'fs32', 56)" class="f">CreateFromText</span>(<span onmouseout="hideTip(event, 'fs5', 57)" onmouseover="showTip(event, 'fs5', 57)" class="i">xsdText</span>)<span class="o">.</span><span class="f">Arbitrary</span>(<span onmouseout="hideTip(event, 'fs23', 58)" onmouseover="showTip(event, 'fs23', 58)" class="i">foo</span>, <span onmouseout="hideTip(event, 'fs30', 59)" onmouseover="showTip(event, 'fs30', 59)" class="i">cust</span>)<span class="o">.</span><span class="i">Generator</span>
<span class="o">|&gt;</span> <span class="i">Gen</span><span class="o">.</span><span class="i">sample</span> <span class="n">5</span> <span class="n">1</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs10', 60)" onmouseover="showTip(event, 'fs10', 60)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 61)" onmouseover="showTip(event, 'fs20', 61)" class="f">iter</span> (<span onmouseout="hideTip(event, 'fs21', 62)" onmouseover="showTip(event, 'fs21', 62)" class="f">printfn</span> <span class="s">&quot;</span><span class="pf">%A</span><span class="s">&quot;</span>)
</code></pre></td>
</tr>
</table>

<p>The equivalent C# code is the following:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="i">var</span> <span class="i">foo</span> <span class="o">=</span> <span class="k">new</span> <span class="i">XmlQualifiedName</span>(<span class="s">&quot;foo&quot;</span>);
<span class="i">var</span> <span class="i">barType</span> <span class="o">=</span> <span class="k">new</span> <span class="i">XmlQualifiedName</span>(<span class="s">&quot;barType&quot;</span>);
<span class="i">var</span> <span class="i">cust</span> <span class="o">=</span> <span class="k">new</span> <span class="i">CustomGenerators</span>()
    <span class="o">.</span><span class="i">ForComplexType</span>(<span class="i">barType</span>, <span class="i">xml</span> <span class="o">=&gt;</span>
    {
        <span class="i">var</span> <span onmouseout="hideTip(event, 'fs33', 63)" onmouseover="showTip(event, 'fs33', 63)" class="i">id</span> <span class="o">=</span> <span class="i">xml</span><span class="o">.</span><span class="i">Attribute</span>(<span class="s">&quot;id&quot;</span>);
        <span onmouseout="hideTip(event, 'fs33', 64)" onmouseover="showTip(event, 'fs33', 64)" class="i">id</span><span class="o">.</span><span class="i">Value</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs33', 65)" onmouseover="showTip(event, 'fs33', 65)" class="i">id</span><span class="o">.</span><span class="i">Value</span><span class="o">.</span><span class="i">ToUpper</span>();
        <span class="k">return</span> <span class="i">xml</span>;
    });
<span class="i">var</span> <span class="i">arb</span> <span class="o">=</span> <span class="i">Schema</span><span class="o">.</span><span class="i">CreateFromText</span>(<span class="i">xsdText</span>)<span class="o">.</span><span class="i">Arbitrary</span>(<span class="i">foo</span>, <span class="i">cust</span>);
<span class="i">var</span> <span class="i">samples</span> <span class="o">=</span> <span class="i">Gen</span><span class="o">.</span><span class="i">Sample</span>(<span class="n">5</span>, <span class="n">1</span>, <span class="i">arb</span><span class="o">.</span><span class="i">Generator</span>);
<span class="i">samples</span><span class="o">.</span><span class="i">ToList</span>()<span class="o">.</span><span class="i">ForEach</span>(<span class="i">Console</span><span class="o">.</span><span class="i">WriteLine</span>);
</code></pre></td>
</tr>
</table>

<p>The main thing to notice is the <code>CustomGenerators</code> class and its method accepting a mapping
for transforming in uppercase the value of the <code>id</code> attribute for all the elements of type <code>barType</code>.
The <code>Arbitrary' instance created embeds a generator, and</code>Gen.sample` is the FsCheck method to create
samples, specifying a size (5 in the example but let's ignore the concept of size for now)
and the number of samples to create.
The element generated may look like this:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="xml"><span class="k">&lt;</span><span class="i">foo</span><span class="k">&gt;</span>
  <span class="k">&lt;</span><span class="i">bar</span> <span class="o">id</span><span class="k">="FX(-K䤊Q&amp;#xA;N(7RIS"</span> <span class="k">/&gt;</span>
  <span class="k">&lt;</span><span class="i">baz</span><span class="k">&gt;</span>j慬X@V'yQy[y9O~r~rTH2kwkwkMA+dzdЁdz:$]s<span class="k">&lt;/</span><span class="i">baz</span><span class="k">&gt;</span>
<span class="k">&lt;/</span><span class="i">foo</span><span class="k">&gt;</span>
</code></pre></td></tr></table>

<p>Yes, text is gibberish (but for testing purposes usually it's a good idea to probe a system
with strange data), anyway you see the value of attribute <code>id</code> is all upper case thanks to 
the customization.</p>

<p>In the next example instead we are creating a generator from scratch using the FsCheck combinators.
Starting from a set of fixed string values, a generator ranging over such a set is built and then mapped
to another one that wraps the random string values in xml element.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs34', 66)" onmouseover="showTip(event, 'fs34', 66)" class="i">baz</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs9', 67)" onmouseover="showTip(event, 'fs9', 67)" class="t">XmlQualifiedName</span>(<span class="s">&quot;baz&quot;</span>)
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs35', 68)" onmouseover="showTip(event, 'fs35', 68)" class="i">abcGen</span> <span class="o">=</span> 
    <span class="i">Gen</span><span class="o">.</span><span class="i">elements</span> [<span class="s">&quot;a&quot;</span>; <span class="s">&quot;b&quot;</span>; <span class="s">&quot;c&quot;</span>] 
    <span class="o">|&gt;</span> <span class="i">Gen</span><span class="o">.</span><span class="i">map</span> (<span class="k">fun</span> <span class="i">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs26', 69)" onmouseover="showTip(event, 'fs26', 69)" class="i">XElement</span>(<span onmouseout="hideTip(event, 'fs16', 70)" onmouseover="showTip(event, 'fs16', 70)" class="i">XName</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 71)" onmouseover="showTip(event, 'fs17', 71)" class="i">Get</span>(<span class="s">&quot;baz&quot;</span>), <span class="i">x</span>))
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 72)" onmouseover="showTip(event, 'fs36', 72)" class="i">cus</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs31', 73)" onmouseover="showTip(event, 'fs31', 73)" class="t">CustomGenerators</span>()<span class="o">.</span><span class="f">ForElement</span>(<span onmouseout="hideTip(event, 'fs34', 74)" onmouseover="showTip(event, 'fs34', 74)" class="i">baz</span>, <span onmouseout="hideTip(event, 'fs35', 75)" onmouseover="showTip(event, 'fs35', 75)" class="i">abcGen</span>)
<span onmouseout="hideTip(event, 'fs7', 76)" onmouseover="showTip(event, 'fs7', 76)" class="t">Schema</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 77)" onmouseover="showTip(event, 'fs32', 77)" class="f">CreateFromText</span>(<span onmouseout="hideTip(event, 'fs5', 78)" onmouseover="showTip(event, 'fs5', 78)" class="i">xsdText</span>)<span class="o">.</span><span class="f">Arbitrary</span>(<span onmouseout="hideTip(event, 'fs23', 79)" onmouseover="showTip(event, 'fs23', 79)" class="i">foo</span>, <span onmouseout="hideTip(event, 'fs36', 80)" onmouseover="showTip(event, 'fs36', 80)" class="i">cus</span>)<span class="o">.</span><span class="i">Generator</span>
<span class="o">|&gt;</span> <span class="i">Gen</span><span class="o">.</span><span class="i">sample</span> <span class="n">5</span> <span class="n">2</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs10', 81)" onmouseover="showTip(event, 'fs10', 81)" class="t">Seq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 82)" onmouseover="showTip(event, 'fs20', 82)" class="f">iter</span> (<span onmouseout="hideTip(event, 'fs21', 83)" onmouseover="showTip(event, 'fs21', 83)" class="f">printfn</span> <span class="s">&quot;</span><span class="pf">%A</span><span class="s">&quot;</span>)
</code></pre></td>
</tr>
</table>

<p>Here's the C# version of the same example:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="i">var</span> <span class="i">baz</span> <span class="o">=</span> <span class="k">new</span> <span class="i">XmlQualifiedName</span>(<span class="s">&quot;baz&quot;</span>);
<span class="i">var</span> <span class="i">abcGen</span> <span class="o">=</span> <span class="i">Gen</span><span class="o">.</span><span class="i">Elements</span>(<span class="k">new</span>[] { <span class="s">&quot;a&quot;</span>, <span class="s">&quot;b&quot;</span>, <span class="s">&quot;c&quot;</span> })
    <span class="o">.</span><span class="i">Select</span>(<span class="i">x</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="i">XElement</span>(<span class="s">&quot;baz&quot;</span>, <span class="i">x</span>));
<span class="i">var</span> <span class="i">cus</span> <span class="o">=</span> <span class="k">new</span> <span class="i">CustomGenerators</span>()<span class="o">.</span><span class="i">ForElement</span>(<span class="i">baz</span>, <span class="i">abcGen</span>);
<span class="i">var</span> <span class="i">arb</span> <span class="o">=</span> <span class="i">Schema</span><span class="o">.</span><span class="i">CreateFromText</span>(<span class="i">xsdText</span>)<span class="o">.</span><span class="i">Arbitrary</span>(<span class="i">foo</span>, <span class="i">cus</span>);
<span class="i">var</span> <span class="i">samples</span> <span class="o">=</span> <span class="i">Gen</span><span class="o">.</span><span class="i">Sample</span>(<span class="n">5</span>, <span class="n">2</span>, <span class="i">arb</span><span class="o">.</span><span class="i">Generator</span>);
<span class="i">samples</span><span class="o">.</span><span class="i">ToList</span>()<span class="o">.</span><span class="i">ForEach</span>(<span class="i">Console</span><span class="o">.</span><span class="i">WriteLine</span>);
</code></pre></td>
</tr>
</table>

<p>Now <code>baz</code> is no more gibberish because we took full control of the random generation:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="xml"><span class="k">&lt;</span><span class="i">foo</span><span class="k">&gt;</span>
  <span class="k">&lt;</span><span class="i">bar</span> <span class="o">id</span><span class="k">=",B{e{e{;%;t^t^t4y4mWmWm-r-fPfPf&amp;amp;k&amp;amp;_"</span> <span class="k">/&gt;</span>
  <span class="k">&lt;</span><span class="i">baz</span><span class="k">&gt;</span>b<span class="k">&lt;/</span><span class="i">baz</span><span class="k">&gt;</span>
<span class="k">&lt;/</span><span class="i">foo</span><span class="k">&gt;</span>
<span class="k">&lt;</span><span class="i">foo</span><span class="k">&gt;</span>
  <span class="k">&lt;</span><span class="i">bar</span> <span class="o">id</span><span class="k">="ZDZB}B}BS=S５"</span> <span class="k">/&gt;</span>
  <span class="k">&lt;</span><span class="i">baz</span><span class="k">&gt;</span>c<span class="k">&lt;/</span><span class="i">baz</span><span class="k">&gt;</span>
<span class="k">&lt;/</span><span class="i">foo</span><span class="k">&gt;</span>
</code></pre></td></tr></table>

<p>FsCheck provides many more combinators to compositionally create many kinds of generators.</p>

<div class="tip" id="fs1">namespace AntaniXml</div>
<div class="tip" id="fs2">namespace System</div>
<div class="tip" id="fs3">namespace System.Xml</div>
<div class="tip" id="fs4">namespace System.Xml.Linq</div>
<div class="tip" id="fs5">val xsdText : string<br /><br />Full name: Customizations.xsdText</div>
<div class="tip" id="fs6">val samples : XElement array<br /><br />Full name: Customizations.samples</div>
<div class="tip" id="fs7">Multiple items<br />namespace System.Xml.Schema<br /><br />--------------------<br />type Schema =<br />&#160;&#160;new : xmlSchemaSet:XmlSchemaSet -&gt; Schema<br />&#160;&#160;member Arbitrary : elementName:XmlQualifiedName -&gt; Arbitrary&lt;XElement&gt;<br />&#160;&#160;member Arbitrary : elementName:XmlQualifiedName * customizations:CustomGenerators -&gt; Arbitrary&lt;XElement&gt;<br />&#160;&#160;member Generator : elementName:XmlQualifiedName -&gt; IXmlElementGenerator<br />&#160;&#160;member Validate : element:XElement -&gt; ValidationResult<br />&#160;&#160;member Validate : element:string -&gt; ValidationResult<br />&#160;&#160;member GlobalElements : IEnumerable&lt;XmlQualifiedName&gt;<br />&#160;&#160;static member CreateFromText : schemaText:string -&gt; Schema<br />&#160;&#160;static member CreateFromUri : schemaUri:string -&gt; Schema<br /><br />Full name: AntaniXml.Schema<br /><br />--------------------<br />new : xmlSchemaSet:Schema.XmlSchemaSet -&gt; Schema</div>
<div class="tip" id="fs8">static member Schema.CreateFromUri : schemaUri:string -&gt; Schema</div>
<div class="tip" id="fs9">Multiple items<br />type XmlQualifiedName =<br />&#160;&#160;new : unit -&gt; XmlQualifiedName + 2 overloads<br />&#160;&#160;member Equals : other:obj -&gt; bool<br />&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;member IsEmpty : bool<br />&#160;&#160;member Name : string<br />&#160;&#160;member Namespace : string<br />&#160;&#160;member ToString : unit -&gt; string<br />&#160;&#160;static val Empty : XmlQualifiedName<br />&#160;&#160;static member ToString : name:string * ns:string -&gt; string<br /><br />Full name: System.Xml.XmlQualifiedName<br /><br />--------------------<br />XmlQualifiedName() : unit<br />XmlQualifiedName(name: string) : unit<br />XmlQualifiedName(name: string, ns: string) : unit</div>
<div class="tip" id="fs10">module Seq<br /><br />from Microsoft.FSharp.Collections</div>
<div class="tip" id="fs11">val mapi : mapping:(int -&gt; &#39;T -&gt; &#39;U) -&gt; source:seq&lt;&#39;T&gt; -&gt; seq&lt;&#39;U&gt;<br /><br />Full name: Microsoft.FSharp.Collections.Seq.mapi</div>
<div class="tip" id="fs12">val i : int</div>
<div class="tip" id="fs13">val xml : XElement</div>
<div class="tip" id="fs14">val bar : XElement</div>
<div class="tip" id="fs15">XContainer.Descendants() : System.Collections.Generic.IEnumerable&lt;XElement&gt;<br />XContainer.Descendants(name: XName) : System.Collections.Generic.IEnumerable&lt;XElement&gt;</div>
<div class="tip" id="fs16">type XName =<br />&#160;&#160;member Equals : obj:obj -&gt; bool<br />&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;member LocalName : string<br />&#160;&#160;member Namespace : XNamespace<br />&#160;&#160;member NamespaceName : string<br />&#160;&#160;member ToString : unit -&gt; string<br />&#160;&#160;static member Get : expandedName:string -&gt; XName + 1 overload<br /><br />Full name: System.Xml.Linq.XName</div>
<div class="tip" id="fs17">XName.Get(expandedName: string) : XName<br />XName.Get(localName: string, namespaceName: string) : XName</div>
<div class="tip" id="fs18">XElement.Attribute(name: XName) : XAttribute</div>
<div class="tip" id="fs19">System.Int32.ToString() : string<br />System.Int32.ToString(provider: System.IFormatProvider) : string<br />System.Int32.ToString(format: string) : string<br />System.Int32.ToString(format: string, provider: System.IFormatProvider) : string</div>
<div class="tip" id="fs20">val iter : action:(&#39;T -&gt; unit) -&gt; source:seq&lt;&#39;T&gt; -&gt; unit<br /><br />Full name: Microsoft.FSharp.Collections.Seq.iter</div>
<div class="tip" id="fs21">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs22">namespace FsCheck</div>
<div class="tip" id="fs23">val foo : XmlQualifiedName<br /><br />Full name: Customizations.foo</div>
<div class="tip" id="fs24">val barType : XmlQualifiedName<br /><br />Full name: Customizations.barType</div>
<div class="tip" id="fs25">val toUpper : xml:XElement -&gt; XElement<br /><br />Full name: Customizations.toUpper</div>
<div class="tip" id="fs26">Multiple items<br />type XElement =<br />&#160;&#160;inherit XContainer<br />&#160;&#160;new : name:XName -&gt; XElement + 4 overloads<br />&#160;&#160;member AncestorsAndSelf : unit -&gt; IEnumerable&lt;XElement&gt; + 1 overload<br />&#160;&#160;member Attribute : name:XName -&gt; XAttribute<br />&#160;&#160;member Attributes : unit -&gt; IEnumerable&lt;XAttribute&gt; + 1 overload<br />&#160;&#160;member DescendantNodesAndSelf : unit -&gt; IEnumerable&lt;XNode&gt;<br />&#160;&#160;member DescendantsAndSelf : unit -&gt; IEnumerable&lt;XElement&gt; + 1 overload<br />&#160;&#160;member FirstAttribute : XAttribute<br />&#160;&#160;member GetDefaultNamespace : unit -&gt; XNamespace<br />&#160;&#160;member GetNamespaceOfPrefix : prefix:string -&gt; XNamespace<br />&#160;&#160;member GetPrefixOfNamespace : ns:XNamespace -&gt; string<br />&#160;&#160;...<br /><br />Full name: System.Xml.Linq.XElement<br /><br />--------------------<br />XElement(name: XName) : unit<br />XElement(other: XElement) : unit<br />XElement(other: XStreamingElement) : unit<br />XElement(name: XName, content: obj) : unit<br />XElement(name: XName, params content: obj []) : unit</div>
<div class="tip" id="fs27">val id : XAttribute</div>
<div class="tip" id="fs28">property XAttribute.Value: string</div>
<div class="tip" id="fs29">System.String.ToUpper() : string<br />System.String.ToUpper(culture: System.Globalization.CultureInfo) : string</div>
<div class="tip" id="fs30">val cust : CustomGenerators<br /><br />Full name: Customizations.cust</div>
<div class="tip" id="fs31">Multiple items<br />type CustomGenerators =<br />&#160;&#160;new : unit -&gt; CustomGenerators<br />&#160;&#160;member ForComplexType : complexTypeName:XmlQualifiedName * mapping:Func&lt;XElement,XElement&gt; -&gt; CustomGenerators<br />&#160;&#160;member ForComplexType : complexTypeName:XmlQualifiedName * generator:Gen&lt;XElement&gt; -&gt; CustomGenerators<br />&#160;&#160;member ForElement : elementName:XmlQualifiedName * mapping:Func&lt;XElement,XElement&gt; -&gt; CustomGenerators<br />&#160;&#160;member ForElement : elementName:XmlQualifiedName * generator:Gen&lt;XElement&gt; -&gt; CustomGenerators<br />&#160;&#160;member private ToMaps : unit -&gt; Maps<br /><br />Full name: AntaniXml.CustomGenerators<br /><br />--------------------<br />new : unit -&gt; CustomGenerators</div>
<div class="tip" id="fs32">static member Schema.CreateFromText : schemaText:string -&gt; Schema</div>
<div class="tip" id="fs33">val id : x:&#39;T -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.id</div>
<div class="tip" id="fs34">val baz : XmlQualifiedName<br /><br />Full name: Customizations.baz</div>
<div class="tip" id="fs35">val abcGen : obj<br /><br />Full name: Customizations.abcGen</div>
<div class="tip" id="fs36">val cus : CustomGenerators<br /><br />Full name: Customizations.cus</div>

        </div>
        <div class="span3">
          <img src="/AntaniXml/img/logo.png" alt="F# Project" style="width:150px;margin:10px" />  
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">AntaniXml</li>
            <li><a href="/AntaniXml/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://nuget.org/packages/AntaniXml">Get Library via NuGet</a></li>
            <li><a href="http://github.com/giacomociti/AntaniXml">Source Code on GitHub</a></li>
            <li><a href="/AntaniXml/license.html">License</a></li>
            <li><a href="/AntaniXml/release-notes.html">Release Notes</a></li>
            
            <li class="nav-header">Getting started</li>
            <li><a href="/AntaniXml/tutorial.html">Tutorial</a></li>
            <li><a href="/AntaniXml/customizations.html">Customizations</a></li>

            <li class="nav-header">Documentation</li>
            <li><a href="/AntaniXml/reference/index.html">API Reference</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/giacomociti/AntaniXml"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
